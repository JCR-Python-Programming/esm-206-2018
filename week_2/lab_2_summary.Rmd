---
title: "Lab 2 Summary"
subtitle: "Bren School (UCSB)"
author: "Allison Horst"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Lab 2 Packages Required

tidyverse

RColorBrewer

#Lab 2 Functions

##New Functions
- group_by: create groups within data frame 
- rename(): rename data frame columns
- factor(): specify column as 'factor' and set order of factor levels by 'levels = ' argument
- summarize(): create summary data frame including functions you select
- write_csv(): export a .csv file containing data frame information

##RMarkdown

RMarkdown resources:

- RMarkdown Cheat Sheet (RStudio > Help > Cheat Sheets)
- <https://rmarkdown.rstudio.com/>

\newpage

###Lab 2 Graph Examples

```{r, include = FALSE}
library(tidyverse)
```

```{r, include = FALSE}
sb_pest <- read_csv("sb_pest.csv") # Read in the sb_pest.csv file
```

```{r, include = FALSE}
# Basic data wrangling (review)

sb_simple <- sb_pest %>% 
  select(COUNTY_NAME, SITE_NAME, CHEMICAL_NAME, POUNDS_CHEMICAL_APPLIED) %>% 
  rename(county = COUNTY_NAME, crop = SITE_NAME, chemical = CHEMICAL_NAME, pounds = POUNDS_CHEMICAL_APPLIED) %>% 
  filter(pounds != "N/A") %>% # Here, also show !is.na(pounds) option
  select(county, chemical, pounds, crop) %>% 
  mutate(pounds = as.numeric(pounds)) # In this case, it DOES overwrite

grapes_summary <- sb_simple %>% 
  group_by(chemical) %>% 
  summarize(
    total_applied = sum(pounds),
    max_applied = max(pounds)
  ) %>% 
  arrange(-total_applied) %>% 
  head(10)

grapes_summary

grape_summary_factor <- grapes_summary %>% 
  mutate(chemical = factor(chemical, levels = chemical))

```

```{r}
top_10_ordered <- ggplot(grape_summary_factor, aes(x = chemical, y = total_applied)) +
  geom_col(aes(fill = chemical), show.legend = FALSE) +
  coord_flip() +
  scale_fill_brewer(palette = "Spectral") + # Note: need package RColorBrewer
  theme_classic() +
  scale_x_discrete(expand = c(0,0)) +
  scale_y_continuous(expand = c(0,0)) +
  labs(x = "", y = "Total pesticide applied to SB County grapes (pounds)")

top_10_ordered

```

```{r, include = FALSE}
sb_glyphosate <- sb_simple %>% 
  filter(chemical == "GLYPHOSATE, ISOPROPYLAMINE SALT")
```
\newpage
```{r}
glyphosate_hist <- ggplot(sb_glyphosate, aes(x = pounds)) +
  geom_histogram(bins = 12, boundary = 0, color = "dodgerblue", fill = "dodgerblue4") +
  labs(x = "Glyphosate Applied (pounds)", 
       y = "Frequency (n = 197)", 
       title = "SB Wine Grape Glyphosate Use (2016)") +
  theme_classic() +
  scale_y_continuous(expand = c(0,0), limits = c(0,150)) +
  scale_x_continuous(expand = c(0,0))
  

glyphosate_hist
```
\newpage
```{r}
insect_boxplot <- ggplot(InsectSprays, aes(x = spray, y = count)) +
  geom_boxplot(outlier.shape = NA) +
  theme_classic() +
  labs(x = "Spray Type", y = "Insect Counts (insects per transect)") +
  geom_jitter(size = 2, width = 0.1, alpha = 0.7, aes(color = spray))

insect_boxplot
```

